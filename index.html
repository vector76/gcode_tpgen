<html>
<head>
<title>G-Code Test Pattern Generator</title>
<style>
.output {
  font-family: monospace;
  font-size: 8pt;
}
</style>
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
</head>
<body>
;Add G92 X0 Y0 Z0 at the beginning: <input type="checkbox" name="zero" checked><br>
;Z level for pen-down:<input type="text" name="pen_d" value="-0.5"><br>
;Z level for pen-up:<input type="text" name="pen_u" value="0.5"><br>
;Rapid Feedrate (mm/min):<input type="text" name="rapid" value="2000"><br>
;Raise/lower Feedrate:<input type="text" name="vertical" value="800"><br>
;Draw Feedrate:<input type="text" name="drawspeed" value="1000"><br>
;Mode:<br>
;  x only: <input type="radio" name="mode" id="mode_x" checked><br>
;  y only: <input type="radio" name="mode" id="mode_y"><br>
;  x and y: <input type="radio" name="mode" id="mode_xy"><br>
;  perimeter: <input type="radio" name="mode" id="mode_perim"><br>
;Y Extent (mm):<input type="text" name="ysize" value="100"><br>
;X Extent (mm):<input type="text" name="xsize" value="100"><br>
<input type="button" value="Generate" onclick="generate()"> 
  
<div id="output" class="output"></div>
<br/>

<script>
  function output_append(x) {
    var output = document.getElementById('output');
    var newcontent = document.createElement('div');
    newcontent.innerHTML = x + "<br>";

    while (newcontent.firstChild) {
        output.appendChild(newcontent.firstChild);
    }
  }

  function x_zig(xstart, xend, ymid, zup, zdn, rapid, vertical, drawspeed) {
    for (var x=xstart; x <= xend; x++) {
      var yend = ymid-0.5;
      var ystart = yend-5.5;  // most draw from ymid-5.5 to ymid-0.5
      if (x % 5 == 0) {
        ystart = ystart - 2;
      }
      if (x % 10 == 0) {
        ystart = ystart - 2;
      }
      output_append("G1 X" + x + " Y" + ystart + zup + " F" + rapid);
      output_append("G1 X" + x + " Y" + ystart + zdn + " F" + vertical);
      output_append("G1 X" + x + " Y" + yend + zdn + " F" + drawspeed);
      output_append("G1 X" + x + " Y" + yend + zup + " F" + vertical);
    }
  }
  
  function x_zag(xstart, xend, ymid, zup, zdn, rapid, vertical, drawspeed) {
    for (var x=xend; x >= xstart; x--) {
      var ystart = ymid + 0.5;
      var yend = ystart + 5.5; // most go from ymid+0.5 to ymid+6
      if (x % 5 == 0) {
        yend = yend + 2;   // 5 and 10 mm go from ymid+0.5 to ymid+8
      }
      if (x % 10 == 0) {
        yend = yend + 2;   // 10 mm goes from ymid+0.5 to ymid+10
      }
      output_append("G1 X" + x + " Y" + ystart + zup + " F" + rapid);
      output_append("G1 X" + x + " Y" + ystart + zdn + " F" + vertical);
      output_append("G1 X" + x + " Y" + yend + zdn + " F" + drawspeed);
      output_append("G1 X" + x + " Y" + yend + zup + " F" + vertical);
    }
  }
  
  function y_zig(xmid, ystart, yend, zup, zdn, rapid, vertical, drawspeed) {
    for (var y=ystart; y <= yend; y++) {
      var xend = xmid-0.5;
      var xstart = xend-5.5;
      if (y % 5 == 0) {
        xstart = xstart - 2;
      }
      if (y % 10 == 0) {
        xstart = xstart - 2;
      }
      output_append("G1 X" + xstart + " Y" + y + zup + " F" + rapid);
      output_append("G1 X" + xstart + " Y" + y + zdn + " F" + vertical);
      output_append("G1 X" + xend + " Y" + y + zdn + " F" + drawspeed);
      output_append("G1 X" + xend + " Y" + y + zup + " F" + vertical);
    }
  }
  
  function y_zag(xmid, ystart, yend, zup, zdn, rapid, vertical, drawspeed) {
    for (var y=yend; y >= ystart; y--) {
      var xstart = xmid + 0.5;
      var xend = xstart + 5.5;
      if (y % 5 == 0) {
        xend = xend + 2;
      }
      if (y % 10 == 0) {
        xend = xend + 2;
      }
      output_append("G1 X" + xstart + " Y" + y + zup + " F" + rapid);
      output_append("G1 X" + xstart + " Y" + y + zdn + " F" + vertical);
      output_append("G1 X" + xend + " Y" + y + zdn + " F" + drawspeed);
      output_append("G1 X" + xend + " Y" + y + zup + " F" + vertical);
    }
  }
  
  
  function generate() {
    // clear output in case it's been run already:
    document.getElementById('output').innerHTML = "";
    
    var zero = document.getElementsByName("zero")[0].checked;
    var pen_d = document.getElementsByName("pen_d")[0].value;
    var pen_u = document.getElementsByName("pen_u")[0].value;
    var rapid = document.getElementsByName("rapid")[0].value;
    var vertical = document.getElementsByName("vertical")[0].value;
    var drawspeed = document.getElementsByName("drawspeed")[0].value;
    var ysize = document.getElementsByName("ysize")[0].value;
    var xsize = document.getElementsByName("xsize")[0].value;
    var mode = "";
    if (document.getElementById("mode_x").checked) {
      mode = "x";
    }
    if (document.getElementById("mode_y").checked) {
      mode = "y";
    }
    if (document.getElementById("mode_xy").checked) {
      mode = "xy";
    }
    if (document.getElementById("mode_perim").checked) {
      mode = "perim";
    }
    
    output_append("; pen down z level: " + pen_d);
    output_append("; pen up z level: " + pen_u);
    output_append("; rapid feedrate: " + rapid);
    output_append("; raise/lower feedrate: " + vertical);
    output_append("; drawing feedrate: " + drawspeed);
    output_append("; x extent: " + xsize);
    output_append("; y extent: " + ysize);
    output_append("; mode: " + mode);
    
    var zup = " Z" + pen_u;
    var zdn = " Z" + pen_d;
    
    if (zero) {
      output_append("G92 X0 Y0 Z0");
    }
    
    if (mode == "x" || mode == "xy" || mode == "perim") {
      x_zig(0, xsize, 10, zup, zdn, rapid, vertical, drawspeed);
      x_zag(0, xsize, 10, zup, zdn, rapid, vertical, drawspeed);
    }
    
    if (mode == "y" || mode == "xy" || mode == "perim") {
      y_zig(10, 0, ysize, zup, zdn, rapid, vertical, drawspeed);
      y_zag(10, 0, ysize, zup, zdn, rapid, vertical, drawspeed);
    }
    
    if (mode == "perim") {
      x_zig(0, xsize, ysize-10, zup, zdn, rapid, vertical, drawspeed);
      x_zag(0, xsize, ysize-10, zup, zdn, rapid, vertical, drawspeed);
      y_zig(xsize-10, 0, ysize, zup, zdn, rapid, vertical, drawspeed);
      y_zag(xsize-10, 0, ysize, zup, zdn, rapid, vertical, drawspeed);
    }
  }
</script>
</body>
</html>